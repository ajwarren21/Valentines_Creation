{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Andrew/Desktop/VDProject/Valentines_Creation/valentine-gift/lib/fulfillment.js"],"sourcesContent":["export async function fulfillGift(gift) {\r\n  switch (gift.giftType) {\r\n    case \"COFFEE\":\r\n      return buildCoffeeLink(gift.giftConfig);\r\n\r\n    case \"GIFTCARD\":\r\n      return await sendGiftCard(gift.giftConfig);\r\n\r\n    case \"CHOCOLATES\":\r\n      return buildAmazonLink(gift.giftConfig);\r\n\r\n    default:\r\n      throw new Error(\"Unknown gift type\");\r\n  }\r\n}\r\n\r\nfunction buildCoffeeLink(config) {\r\n  const params = new URLSearchParams({\r\n    drink: config.drink,\r\n    size: config.size,\r\n    milk: config.milk,\r\n  });\r\n\r\n  return `https://www.starbucks.com/menu/product?${params.toString()}`;\r\n}\r\n\r\nfunction buildAmazonLink(config) {\r\n  return `https://www.amazon.com/dp/${config.asin}?tag=${config.affiliateTag}`;\r\n}\r\n\r\n\r\n// Make real api later\r\nasync function sendGiftCard(config) {\r\n  // Later: call Tango / Rybbon API\r\n  return {\r\n    redemptionCode: \"TEST-CODE-123\",\r\n    amount: config.amount,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAAO,eAAe,YAAY,IAAI;IACpC,OAAQ,KAAK,QAAQ;QACnB,KAAK;YACH,OAAO,gBAAgB,KAAK,UAAU;QAExC,KAAK;YACH,OAAO,MAAM,aAAa,KAAK,UAAU;QAE3C,KAAK;YACH,OAAO,gBAAgB,KAAK,UAAU;QAExC;YACE,MAAM,IAAI,MAAM;IACpB;AACF;AAEA,SAAS,gBAAgB,MAAM;IAC7B,MAAM,SAAS,IAAI,gBAAgB;QACjC,OAAO,OAAO,KAAK;QACnB,MAAM,OAAO,IAAI;QACjB,MAAM,OAAO,IAAI;IACnB;IAEA,OAAO,CAAC,uCAAuC,EAAE,OAAO,QAAQ,IAAI;AACtE;AAEA,SAAS,gBAAgB,MAAM;IAC7B,OAAO,CAAC,0BAA0B,EAAE,OAAO,IAAI,CAAC,KAAK,EAAE,OAAO,YAAY,EAAE;AAC9E;AAGA,sBAAsB;AACtB,eAAe,aAAa,MAAM;IAChC,iCAAiC;IACjC,OAAO;QACL,gBAAgB;QAChB,QAAQ,OAAO,MAAM;IACvB;AACF"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Andrew/Desktop/VDProject/Valentines_Creation/valentine-gift/src/app/api/gift/%5Bslug%5D/route.js"],"sourcesContent":["import { fulfillGift } from \"@/../lib/fulfillment\";\r\n\r\nexport async function PATCH(req, { params }) {\r\n  const gift = await prisma.gift.findUnique({\r\n    where: { slug: params.slug },\r\n  });\r\n\r\n  if (!gift || gift.status === \"ACCEPTED\") {\r\n    return NextResponse.json({ error: \"Invalid state\" }, { status: 400 });\r\n  }\r\n\r\n  const fulfillmentResult = await fulfillGift(gift);\r\n\r\n  await prisma.gift.update({\r\n    where: { id: gift.id },\r\n    data: {\r\n      status: \"FULFILLED\",\r\n      respondedAt: new Date(),\r\n      giftConfig: {\r\n        ...gift.giftConfig,\r\n        fulfillmentResult,\r\n      },\r\n    },\r\n  });\r\n\r\n  return NextResponse.json({ fulfillmentResult });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,MAAM,GAAG,EAAE,EAAE,MAAM,EAAE;IACzC,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE,MAAM,OAAO,IAAI;QAAC;IAC7B;IAEA,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,YAAY;QACvC,OAAO,aAAa,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACrE;IAEA,MAAM,oBAAoB,MAAM,IAAA,mIAAW,EAAC;IAE5C,MAAM,OAAO,IAAI,CAAC,MAAM,CAAC;QACvB,OAAO;YAAE,IAAI,KAAK,EAAE;QAAC;QACrB,MAAM;YACJ,QAAQ;YACR,aAAa,IAAI;YACjB,YAAY;gBACV,GAAG,KAAK,UAAU;gBAClB;YACF;QACF;IACF;IAEA,OAAO,aAAa,IAAI,CAAC;QAAE;IAAkB;AAC/C"}}]
}